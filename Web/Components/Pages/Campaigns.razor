@page "/Campaigns"
@using Application.Services.Campaigns
@using Domain.Entities

@inject ICampaignService CampaignService

<PageTitle>Campaigns</PageTitle>

<MudContainer MaxWidth="MaxWidth.Large" Class="py-8">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-6">
        <MudText Typo="Typo.h4" Class="font-weight-bold">
            Campaigns
        </MudText>

        <MudButton Variant="Variant.Filled"
                   Color="Color.Primary"
                   StartIcon="@Icons.Material.Filled.AddBox"
                   Href="/Campaigns/Create">
            Add Campaign
        </MudButton>
    </div>


    <!-- GRID VIEW -->
    <MudDataGrid T="Campaign"
                 Items="@_campaigns"
                 Hover="true"
                 Striped="true"
                 Bordered="true"
                 Dense="true"
                 Filterable="true"
                 SortMode="SortMode.Multiple"
                 Class="elevation-1">

        <Columns>

            <PropertyColumn Property="x => x.Id"
                            Title="ID"
                            Sortable="true" />

            <PropertyColumn Property="x => x.Title"
                            Title="Title"
                            Sortable="true" />

            <PropertyColumn Property="x => x.Description"
                            Title="Description" />

            <PropertyColumn Property="x => x.StartDate"
                            Title="Start Date"
                            Format="dd MMM yyyy"
                            Sortable="true" />

            <PropertyColumn Property="x => x.EndDate"
                            Title="End Date"
                            Format="dd MMM yyyy"
                            Sortable="true" />

            <PropertyColumn Property="x => x.Budget"
                            Title="Budget"
                            Format="C"
                            Sortable="true" />

            <!-- Status Column -->
            <TemplateColumn Title="Status">
                <CellTemplate>
                    <MudChip T="string"
                             Color="@(context.Item.IsActive ? Color.Success : Color.Error)"
                             Text="@(context.Item.IsActive ? "Active" : "Inactive")"
                             Variant="Variant.Filled" />
                </CellTemplate>
            </TemplateColumn>

            <PropertyColumn Property="x => x.CreatedAt"
                            Title="Created At"
                            Format="dd MMM yyyy"
                            Sortable="true" />

            <!-- Actions -->
            <TemplateColumn Title="Actions">
                <CellTemplate>

                    <MudIconButton Icon="@Icons.Material.Filled.Info"
                                   Color="Color.Info"
                                   Size="Size.Small"
                                   Href="@($"/Campaigns/{context.Item.Id}")"
                                   Title="View Details" />

                    <MudIconButton Icon="@Icons.Material.Filled.Edit"
                                   Color="Color.Primary"
                                   Size="Size.Small"
                                   Href="@($"/Campaigns/edit/{context.Item.Id}")"
                                   Title="Edit Campaign" />

                </CellTemplate>
            </TemplateColumn>

        </Columns>

    </MudDataGrid>

</MudContainer>

@code {

    List<Campaign> _campaigns = new();

    protected override async Task OnInitializedAsync()
    {
        _campaigns = CampaignService.GetAllCampaigns();
    }
}
